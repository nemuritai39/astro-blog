---
import { SITE_TITLE } from '../consts';

// 获取当前路径，用于判断哪个标签是激活状态
const { pathname } = Astro.url;
const isActive = (path: string) => path === pathname || path === pathname.replace(/\/$/, '');
---

<header id="main-header">
	<nav>
		<div class="nav-container">
			<div class="logo">
				<a href="/">{SITE_TITLE}</a>
			</div>
			<div class="internal-links">
				<a href="/" class={isActive('/') ? 'active' : ''}>Index</a>
				<a href="/writing" class={isActive('/writing') ? 'active' : ''}>Writing</a>
				<a href="/gallery" class={isActive('/gallery') ? 'active' : ''}>Gallery</a>
				<a href="/about" class={isActive('/about') ? 'active' : ''}>About</a>
			</div>
		</div>
	</nav>
</header>

<style>
	header {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		z-index: 1000;
		background: rgba(0, 0, 0, 0.3); /* 初始微弱背景，确保可见 */
		backdrop-filter: blur(0px);
		transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
		padding: 35px 0;
	}

	header.scrolled {
		padding: 18px 0;
		background: rgba(10, 10, 10, 0.8);
		backdrop-filter: blur(20px);
		border-bottom: 1px solid rgba(214, 178, 94, 0.2);
	}

	nav {
		max-width: 1200px;
		margin: 0 auto;
		padding: 0 40px;
	}

	.nav-container {
		display: flex;
		align-items: center;
		justify-content: space-between;
	}

	.logo a {
		font-family: 'Cinzel', serif;
		font-size: 1rem;
		font-weight: 700;
		color: #fff;
		text-decoration: none;
		letter-spacing: 0.3em;
		text-transform: uppercase;
	}

	.internal-links {
		display: flex;
		gap: 3rem;
	}

	/* 重点：强制让标签显示的样式 */
	.internal-links a {
		display: inline-block;
		font-family: 'Cinzel', serif;
		font-size: 0.8rem;
		text-transform: uppercase;
		letter-spacing: 0.2em;
		color: rgba(255, 255, 255, 0.6); /* 没选中的时候是淡灰色 */
		text-decoration: none;
		position: relative;
		transition: all 0.3s ease;
		padding: 5px 0;
	}

	/* 悬停效果 */
	.internal-links a:hover {
		color: #fff;
		opacity: 1;
	}

	/* 选中状态（激活态） */
	.internal-links a.active {
		color: var(--accent-gold, #d6b25e);
		opacity: 1;
	}

	/* 激活态的小金点 */
	.internal-links a.active::after {
		content: '';
		position: absolute;
		bottom: -5px;
		left: 50%;
		transform: translateX(-50%);
		width: 4px;
		height: 4px;
		background: var(--accent-gold, #d6b25e);
		border-radius: 50%;
		box-shadow: 0 0 10px var(--accent-gold);
	}

	@media (max-width: 768px) {
		.logo { display: none; }
		.internal-links { width: 100%; justify-content: center; gap: 1.5rem; }
		.internal-links a { font-size: 0.7rem; }
	}
</style>

<script>
	const header = document.getElementById('main-header');
	window.addEventListener('scroll', () => {
		if (window.scrollY > 20) {
			header?.classList.add('scrolled');
		} else {
			header?.classList.remove('scrolled');
		}
	});
</script>
