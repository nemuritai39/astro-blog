---
import BaseHead from "../../components/BaseHead.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import { getCollection } from "astro:content";

const pageTitle = "Writing · 随笔";
const heading = "随笔";
const description = "记录日常、片段与叙述。";

const posts = (await getCollection("essays"))
  .filter((p) => !p.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<html lang="en">
  <head>
    <BaseHead title={pageTitle} description={description} />
    <style>
      .wrap { max-width: 1100px; margin: 0 auto; padding: 56px 20px; }
      .top h1 { margin:0; letter-spacing:.02em; }
      .sub { opacity:.82; margin-top:10px; }
      .list { display:flex; flex-direction:column; gap:12px; margin-top:18px; }
      .item {
        display:block; padding:14px 16px;
        border:1px solid rgba(255,255,255,.14);
        border-radius:16px; background:#ffffff05;
        text-decoration:none; color:inherit;
      }
      .item:hover { border-color: rgba(214,178,94,.65); }
      .t { font-weight:700; }
      .d { opacity:.75; margin-top:6px; line-height:1.6; }
      .meta { opacity:.65; font-size:.92rem; margin-top:6px; }
      .empty { opacity:.7; margin-top: 14px; }
      code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    </style>
  </head>

  <body>
    <Header />
    <main class="wrap">
      <header class="top">
        <h1>{heading}</h1>
        <p class="sub">{description}</p>
      </header>

      <section class="list">
        {posts.length === 0 ? (
          <p class="empty">
            （这里还没有内容）请确认文章在 <code>src/content/essays/</code> 下，且 frontmatter 至少包含
            <code> title</code> 与 <code>pubDate</code>。
          </p>
        ) : (
          posts.map((p) => (
            <a class="item" href={`/writing/essays/${p.slug}/`}>
              <div class="t">{p.data.title}</div>
              {p.data.description && <div class="d">{p.data.description}</div>}
              <div class="meta">{p.data.pubDate.toISOString().slice(0, 10)}</div>
            </a>
          ))
        )}
      </section>
    </main>
    <Footer />
  </body>
</html>
