---
import { getCollection, render } from 'astro:content';
// 核心修复：这里在三级目录下，需要退三层
import BaseHead from "../../../components/BaseHead.astro";
import Header from "../../../components/Header.astro";
import Footer from "../../../components/Footer.astro";

export async function getStaticPaths() {
  const entries = await getCollection('essays');
  return entries.map(entry => ({
    params: { slug: entry.id },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await render(entry);
---

<html lang="en">
  <head>
    <BaseHead title={entry.data.title} description={entry.data.description} />
    <style>
      .content-wrap { max-width: 800px; margin: 0 auto; padding: 100px 20px; }
      .back { display: block; margin-bottom: 40px; color: #d6b25e; text-decoration: none; font-family: var(--font-mono); }
      .back:hover { text-decoration: underline; }
      .title { font-family: var(--font-display); font-size: clamp(32px, 5vw, 48px); color: #d6b25e; line-height: 1.2; margin-bottom: 10px; }
      .meta { font-family: var(--font-mono); opacity: 0.5; font-size: 14px; margin-bottom: 60px; display: flex; gap: 20px; }
      .meta::before { content: "✥"; color: #d6b25e; }
      .prose { line-height: 1.8; font-size: 18px; color: rgba(255,255,255,0.9); }
      /* 针对 Markdown 内容的样式 */
      .prose :global(h2) { font-family: var(--font-display); color: #d6b25e; margin: 40px 0 20px; }
      .prose :global(p) { margin-bottom: 1.5em; }
    </style>
  </head>
  <body>
    <Header />
    <main class="content-wrap">
      <a href="/writing/essays" class="back">† Back to Essays</a>
      <article>
        <h1 class="title">{entry.data.title}</h1>
        <div class="meta">{entry.data.pubDate.toLocaleDateString()}</div>
        <div class="prose">
          <Content />
        </div>
      </article>
    </main>
    <Footer />
  </body>
</html>
